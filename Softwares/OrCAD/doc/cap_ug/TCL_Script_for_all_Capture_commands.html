<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>
      TCL Script for all Capture commands
    </title>
    <meta name="Approver" content="Technical Publications" />
    <meta name="Author" content="Technical Publications" />
    <meta name="CreateDate" content="2012-10-10" />
    <meta name="CreateTime" content="1349876206" />
    <meta name="DataType" content="Manuals" />
    <meta name="Description" content="UG" />
    <meta name="DocTitle" content="OrCAD Capture User Guide" />
    <meta name="DocType" content="User Guide" />
    <meta name="FileTitle"
    content="TCL Script for all Capture commands" />
    <meta name="Keywords" content="" />
    <meta name="FileType" content="Chapter" />
    <meta name="Keyword" content="cap_ug" />
    <meta name="Language" content="English" />
    <meta name="ModifiedDate" content="2012-10-10" />
    <meta name="ModifiedTime" content="1349876206" />
    <meta name="NextFile"
    content="TCL%2Bscript%2Bfor%2Bspecific%2BCapture%2Bcommands.html" />
    <meta name="Group" content="" />
    <meta name="Platform" content="All," />
    <meta name="PrevFile"
    content="Creating%2Ba%2BCapture%2BTCL%2BScript.html" />
    <meta name="Product"
    content="Allegro Design Entry CIS,OrCAD Capture," />
    <meta name="ProductFamily"
    content="Silicon-Package-Board Co-Design,Silicon-Package-Board Co-Design," />
    <meta name="ProductVersion" content="16.6" />
    <meta name="RightsManagement"
    content="Copyright 2011-2012 Cadence Design Systems Inc." />
    <meta name="Title"
    content="OrCAD Capture User Guide -- TCL Script for all Capture commands" />
    <meta name="Version" content="16.6" />
    <meta name="Renderer" content="WIKI" />
    <meta name="SpaceKey" content="capug166" />
    <link href="styles/site.css" rel="stylesheet"
    type="text/css" />
    <meta content="text/html; charset=UTF-8"
    http-equiv="Content-Type" />
  </head>
  <body style="margin-left: 5%;background-color: #FFFFFF;">
    <a xmlns:html="http://www.w3.org/1999/xhtml" id="pagetop"
    name="pagetop"></a> <a
    xmlns:html="http://www.w3.org/1999/xhtml" id="firstpage"
    name="firstpage"></a> <!-- Begin Buttons -->
     
    <table xmlns:html="http://www.w3.org/1999/xhtml" border="0"
    cellpadding="0" cellspacing="0" width="650">
      <tbody>
        <tr>
          <td colspan="10" height="36" width="650">
            <img height="34" src="../support/header_doc.gif"
            width="650" />
          </td>
        </tr>
        <tr>
          <td height="20" width="59">
            <a href="javascript:openLibrary()"><img
            alt="View Library" border="0" height="20"
            src="../support/nav2_library.gif" width="59" /></a>
          </td>
          <td height="20" width="73">
            <a href="cap_ugTOC.html"><img alt="Table of Contents"
            border="0" src="../support/nav2_toc.gif" /></a>
          </td>
          <td height="20" width="46">
            <img alt="Index" border="0"
            src="../support/nav2_index_b.gif" />
          </td>
          <td>
            <a href="Creating_a_Capture_TCL_Script.html"><img
            alt="Previous" border="0"
            src="../support/nav2_previous.gif" /></a>
          </td>
          <td>
            <a
            href="TCL_script_for_specific_Capture_commands.html"><img
             alt="Next" border="0"
            src="../support/nav_next.gif" /></a>
          </td>
          <td height="20">
            <a href="cap_ug.pdf"><img alt="Open PDF to print book"
            border="0" height="20" src="../support/nav2_print.gif"
            width="114" /></a>
          </td>
          <td height="20" width="61">
            <img src="../support/nav2_black.gif" />
          </td>
          <td height="20" width="76">
            <a href="/feedback.htm"><img alt="Email Comments"
            border="0" height="20"
            src="../support/nav2_feedback.gif" width="76" /></a>
          </td>
          <td height="20" width="43">
            <a href="../cdsuser/help.html"><img
            alt="Help Using Documentation" border="0" height="20"
            src="../support/nav2_help.gif" width="43" /></a>
          </td>
          <td height="20" width="37">
            <a href="/exitsearch.htm"><img
            alt="Shut Down Cadence Documentation Server" border="0"
            height="20" src="../support/nav2_exit.gif"
            width="37" /></a>
          </td>
        </tr>
      </tbody>
    </table><!-- End Buttons -->
    <hr xmlns:html="http://www.w3.org/1999/xhtml" />
    <div id="main-header">
      <a xmlns="" id="TCLScriptforallCapturecommands"
      name="TCLScriptforallCapturecommands"></a> 
      <h1 xmlns="" style=" margin: 4px 0 4px;">
        <span>TCL Script for all Capture commands</span>
      </h1>
    </div>
    <div class="wiki-content group" id="main-content">
      <p>
        When you perform an operation in Capture, the associated
        TCL command is registered with the TCL interpreter. The
        command is logged to a Capture TCL file. In addition, the
        command displays in the Capture Command window.
      </p>
      <p>
        To enabled logging each command that you execute in Capture
        to a TCL script file, you need to execute the SetOptionBool
        command in the Capture Command window.
      </p>
      <div class="preformatted panel" style="border-width: 1px;">
        <div class="preformattedContent panelContent">
<pre>
SetOptionBool Journaling TRUE
</pre>
        </div>
      </div>
      <p>
        This is because, in Capture, by default, the TCL logging
        feature is disabled.
      </p>
      <p>
        Also, if you are in the TCL command logging mode, you can
        view each executed Capture command in the Command window.
        Use the SetOptionBool command to enable viewing of the
        corresponding TCL command for each Capture command in the
        Command window.
      </p>
      <div class="preformatted panel" style="border-width: 1px;">
        <div class="preformattedContent panelContent">
<pre>
SetOptionBool DisplayCommands TRUE
</pre>
        </div>
      </div>
      <div class="panelMacro">
        <table class="noteMacro">
          <colgroup>
            <col width="24" />
            <col />
          </colgroup>
          <tr>
            <td valign="top">
              <img align="absmiddle" alt="" border="0" height="16"
              src="images/icons/emoticons/warning.png"
              width="16" />
            </td>
            <td>
              <p>
                If you enable the display of TCL commands, the TCL
                commands, for each Capture command, are displayed
                in the session log. However, one Capture command
                corresponds, in some cases, to a set of multiple
                TCL commands. Also, the Capture operation is
                performed only after the corresponding TCL commands
                are displayed in the session log. This implies that
                if a Capture command corresponds to a number of TCL
                commands, this may cause a delay in completing the
                Capture command. To avoid this display, you can
                turn off the display functionality using the
                <code>SetOptionBool</code> command using the FALSE
                argument.
              </p>
<pre>
SetOptionBool DisplayCommands FALSE
</pre>
              <p>
                For this reason,command display in the Command
                window is disabled, by default.
              </p>
            </td>
          </tr>
        </table>
      </div>
      <p>
        &#160;
      </p>
      <h4
      id="TCLScriptforallCapturecommands-1827717LocationoftheTCLfile">
        <span class="confluence-anchor-link"
        id="TCLScriptforallCapturecommands-1827717"></span>
        <em>Location of the TCL file</em>
      </h4>
      <p>
        If you enable TCL logging in Capture (using the
        SetOptionBool command), a TCL file, for each Capture
        session, is created in the Temp\CAPTURELOG directory.<br />
         The location of the Temp directory is defined in the
        following order of preference:
      </p>
      <ul>
        <li>
          The path specified by the TMP environment variable
        </li>
        <li>
          The path specified by the TEMP environment variable
        </li>
        <li>
          The path specified by the USERPROFILE environment
          variable
        </li>
        <li>
          The Windows directory
        </li>
      </ul>
      <p>
        This directory contains the Capture TCL file
        OrCaptureLogFile.captcl along with support files required
        to execute the script.
      </p>
      <h4
      id="TCLScriptforallCapturecommands-1828076CaptureDialogsettingsinTCL">
        <span class="confluence-anchor-link"
        id="TCLScriptforallCapturecommands-1828076"></span>
        <em>Capture Dialog settings in TCL</em>
      </h4>
      <p>
        When you perform an operation in Capture that involves a
        dialog box (like Options - Preferences), the Capture TCL
        logging feature saves the complete dialog settings to an
        Xml file. This file is placed in the same location as the
        current session TCL file.
      </p>
      <p>
        For example, to annotate a design you use the Annotate
        dialog box.
      </p>
      <p>
        The associated TCL command for this operation is:
      </p>
<pre>
Menu &quot;Tools::Annotate&quot; | DialogBox &quot;OK&quot; &quot;C:/Temp/CAPTURELOG/Wed_Nov_18_14_34_45_2009/Packaging_6.xml&quot;
</pre>
      <p>
        Notice that an Xml file is one of the arguments in the TCL
        command. Also, notice the location of the Xml file is the
        same as the location of the current Capture session TCL
        file.
      </p>
      <div class="panelMacro">
        <table class="noteMacro">
          <colgroup>
            <col width="24" />
            <col />
          </colgroup>
          <tr>
            <td valign="top">
              <img align="absmiddle" alt="" border="0" height="16"
              src="images/icons/emoticons/warning.png"
              width="16" />
            </td>
            <td>
              <p>
                The location of the CAPTURELOG directory in the
                above example is <code>C:\Temp</code>. However this
                may change depending on the conditions as described
                in the <em><span class="confluence-link">Location
                of the TCL file</span></em> section.
              </p>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <hr xmlns:html="http://www.w3.org/1999/xhtml" />
    <hr xmlns:html="http://www.w3.org/1999/xhtml" align="left" />
    <div xmlns:html="http://www.w3.org/1999/xhtml"
    style="text-align: left;">
      <!-- Begin Buttons -->
      <table border="0" cellpadding="0" cellspacing="0"
      width="650">
        <tbody>
          <tr>
            <td colspan="10" height="36" width="650">
              <img height="34" src="../support/header_doc.gif"
              width="650" />
            </td>
          </tr>
          <tr>
            <td height="20" width="59">
              <a href="javascript:openLibrary()"><img
              alt="View Library" border="0" height="20"
              src="../support/nav2_library.gif" width="59" /></a>
            </td>
            <td height="20" width="73">
              <a href="cap_ugTOC.html"><img alt="Table of Contents"
              border="0" src="../support/nav2_toc.gif" /></a>
            </td>
            <td height="20" width="46">
              <img alt="Index" border="0"
              src="../support/nav2_index_b.gif" />
            </td>
            <td>
              <a href="Creating_a_Capture_TCL_Script.html"><img
              alt="Previous" border="0"
              src="../support/nav2_previous.gif" /></a>
            </td>
            <td>
              <a
              href="TCL_script_for_specific_Capture_commands.html"><img
               alt="Next" border="0"
              src="../support/nav_next.gif" /></a>
            </td>
            <td height="20">
              <a href="cap_ug.pdf"><img
              alt="Open PDF to print book" border="0" height="20"
              src="../support/nav2_print.gif" width="114" /></a>
            </td>
            <td height="20" width="61">
              <img src="../support/nav2_black.gif" />
            </td>
            <td height="20" width="76">
              <a href="/feedback.htm"><img alt="Email Comments"
              border="0" height="20"
              src="../support/nav2_feedback.gif" width="76" /></a>
            </td>
            <td height="20" width="43">
              <a href="../cdsuser/help.html"><img
              alt="Help Using Documentation" border="0" height="20"
              src="../support/nav2_help.gif" width="43" /></a>
            </td>
            <td height="20" width="37">
              <a href="/exitsearch.htm"><img
              alt="Shut Down Cadence Documentation Server"
              border="0" height="20" src="../support/nav2_exit.gif"
              width="37" /></a>
            </td>
          </tr>
        </tbody>
      </table><!-- End Buttons -->
    </div><br xmlns:html="http://www.w3.org/1999/xhtml" />
     <font xmlns:html="http://www.w3.org/1999/xhtml" size="-1">For
    support, see <a href="http://support.cadence.com"
    target="_blank">Cadence Online Support</a> service.</font> <br
    xmlns:html="http://www.w3.org/1999/xhtml" />
     <br xmlns:html="http://www.w3.org/1999/xhtml" />
     <font xmlns:html="http://www.w3.org/1999/xhtml"
    size="-1"><i>Copyright &#169; 2012, <a
    href="http://www.cadence.com">Cadence Design Systems,
    Inc.</a></i></font> <br
    xmlns:html="http://www.w3.org/1999/xhtml" />
     <font xmlns:html="http://www.w3.org/1999/xhtml" size="-1">All
    rights reserved.</font> <br
    xmlns:html="http://www.w3.org/1999/xhtml" />
     <br xmlns:html="http://www.w3.org/1999/xhtml" />
  </body>
</html>
